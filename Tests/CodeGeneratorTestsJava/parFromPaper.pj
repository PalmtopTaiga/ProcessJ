proc void p1(chan<int>.read c) [yield=true]{
	int y = c.read();
}

proc void p2(chan<int>.write c, int x) [yield=true]{
	c.write(x);
}

proc int p3(int y){
	return y;
}
proc int p4(int z){
	return z;	
}

proc void foo(int x) [yield=true]{

  chan<int> c;
  par {
    //x = c.read();
    p1(c.read);
    p2(c.write, x);
  }
  
  bar(10); 
  
  par {
  	int p = p3(4);
  	int k = p4(5);
  	if(x ==5)
  		x = 10;
  }
}

proc void bar(int y) [yield=false]{
	y = y+10;
}

proc void main(string[] args) {
	foo(5);
}
